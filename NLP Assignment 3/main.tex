\documentclass[a4paper,12pt]{ETHexercise}
\usepackage{bbm}

\input{preamble}

\usepackage{multirow}
\title{NLP Assignment}
\begin{document}
\setserie{1}



\lectureheader{Prof. Ryan Cotterell}
{}
{\Large Natural Language Processing}{Fall 2022}
\begin{center}
    {\Huge Yannick Wattenberg: Assignment 03}\\
      \quad\newline
      ywattenberg@inf.ethz.ch, 19-947-464.\\
      \quad\newline
    \timestamp

\end{center}
\section*{Question 1: Exploring the Kleene Star}
\subsection*{a)}
To prove: 
\begin{align*}
    a^* &\stackrel{!}{=} 1 \oplus a \otimes a^* \\
\end{align*}
\begin{align}
    a^* &= \bigoplus^{\infty}_{n=0}a^{\otimes n} &&(\text{def.} *)\\
    &= 1 \oplus \bigoplus^{\infty}_{n=1}a^{\otimes n}  &&(\text{def.} \oplus)\\
    &= 1 \oplus a \otimes \bigoplus^{\infty}_{n=0}a^{\otimes n}  &&(\text{diss. of } \otimes \text{over } \oplus)\\
\end{align}

\subsection*{b)}
We want to find a Kleene Star for $\mathcal{W}_{log}$. Using the definition of Kleene Star, we have:
\begin{align}
    a^* &= \bigoplus^{\infty}_{n=0}a^{\otimes n} &&(\text{def.} *)\\
     &= 0 \oplus_{log} a \oplus_{log} a \otimes a \oplus_{log} \dots\\
     &= \ln(\exp(0) + \exp(a)) \oplus_{log} a + a \oplus_{log} \dots &&(\text{def.} \oplus, \otimes)\\
     &= \ln(\exp(\ln(\exp(0) + \exp(a))) + exp(2a)) \oplus_{log} \dots \\
     &= \ln(\exp(0) + \exp(a)+ \exp(2a)) \oplus_{log} \dots \\
     &= \ln(\sum^\infty_{n=0} \exp(a \cdot n))\\
\end{align}
For $a \geq 0$ this series will diverge as $n \to \infty $, because $\lim_{n \to \inf} \exp(a\cdot n) \geq 1$ in that case.

Thus we assume that $a < 0$ for the rest of the proof. We can then rewrite the series as a geometric series as follows: 
\begin{align}
    \sum^\infty_{n=0} \exp(a \cdot n) &= \sum^\infty_{n=0} g^n &&(\text{where } g = \exp(a))\\
    &= \frac{1}{1-g} &&(\text{limit of the geometric series})\\
    &= \frac{1}{1-\exp(a)} &&(\text{def.} g)  
\end{align}
For the Kleene Star expression we then get:
\begin{align*}
    a^* &= \ln \left( \frac{1}{1-\exp(a)} \right)
\end{align*}
\subsection*{c)}
We want to find a Kleene Star for the expectation semiring. Following the same pattern as in the previous part, the definition gives us:

\begin{align}
    \text{let} a &= \pair{x}{y} \in \mathcal{R} \times \mathcal{R} \\
    a^* &= \bigoplus^{\infty}_{n=0}a^{\otimes n}\\
    &= \bigoplus^{\infty}_{n=0}\pair{x}{y}^{\otimes n}\\
    &= \pair{1}{0} \oplus \pair{x}{y} \oplus \pair{x^2}{2xy} \oplus \pair{x^3}{3x^2y} \oplus \dots\\
    &= \bigoplus^{\infty}_{n=0}\pair{x^n}{nx^{n-1}y}\\
    &= \pair{\sum^{\infty}_{n=0} x^n}{\sum^{\infty}_{n=0} nx^{n-1}y}
\end{align}
We can now explore the limit of both of the series individually. For the first one we have:
\begin{align}
    \sum^{\infty}_{n=0} x^n &= \frac{1}{1-x} &&(\text{limit of the geometric series})\\
\end{align}
Assuming that $|x| < 1$, as otherwise the series would diverge. For the second one we have:
\begin{align}
    \sum^{\infty}_{n=0} nx^{n-1}y  
    &= y \cdot (\sum^{\infty}_{n=0} nx^{n-1}) \\
    &= y \cdot (\sum^{\infty}_{n=0} (n+1)x^{n})  \\
    &= \frac{y}{(x-1)^2} &&(\text{limit of the power series})
\end{align}
With the same assumption as before, we can now combine the two limits to get:
\begin{align*}
    \pair{x}{y}^* &= \pair{\frac{1}{1-x}}{\frac{y}{(x-1)^2}}
\end{align*}
for $|x| < 1$.

\subsection*{d)}

Now we want to find a Kleene Star for $\mathcal{W}_{lang}$. Using the definition of Kleene Star, we have:
\begin{align}
    A* &= \bigoplus^{\infty}_{n=0}A^{\otimes n} &&(\text{def.} *)\\
     &= \epsilon \cup A \cup A \otimes A \cup \dots\\ 
     &= \epsilon \cup A \cup A \circ A \cup \dots\\ 
\end{align}

\section*{Question 2: Asterating Matrices in Idempotent Semirings}
\subsection*{a)}
For the tropical semiring, let $a \in \mathcal{R}_{\geq 0}$ be an element of the tropical semiring, we get:
\begin{align}
    0 \oplus a &= \min(0, a) &&(\text{def.} \oplus)\\
    &= 0 &&(a \in \mathcal{R}_{\geq 0})\\
\end{align}

For the artic semiring, let $a \in \mathcal{R}_{\leq 0}$ be an element of the artic semiring, we get:
\begin{align}
    0 \oplus a &= \max(0, a) &&(\text{def.} \oplus)\\
    &= 0 &&(a \in \mathcal{R}_{\leq 0})\\
\end{align}
Thus we can conclude that both the tropical and artic semirings are 0-closed.

\subsection*{b)}
We prove that the $M^n$ encodes the sum of paths of length $n$ in the graph $G$ using induction over $n$.
For $n = 1$ we have:
The matrix $M$ encodes the transition matrix of the graph $G$. Thus it encodes all paths of length one.

Our induction hypothesis is that $M^n$ encodes the sum of paths of length $n$ in the graph $G$. We want to show that $M^{n+1}$ encodes the sum of paths of length $n+1$.
We have $M^{n+1} = M^{n} \otimes M$ as $M^{n}$ encodes the sum of paths of length $n$ and $M$ encodes the sum of paths of length one.
For some $i, j \in [1,...,N]$ we have:
\begin{align}
    (M^{n+1})_{i,k} = \bigoplus_{k=1}^{N} (M^n)_{ik} \otimes M_{kj}
\end{align}
Thus as we can see $(M^{n+1})_{i,k}$ encodes the sum of all paths of length $n+1$ from $i$ to $k$ as
it is the sum of all paths of length $n$ from $i$ to some $k$ concatenated with a path of length one from $k$ to $j$.

\subsection*{c)}
Assume that there is a shortest path from $i$ to $j$ that traverses more than $N-1$ transitions/edges.
It follows that at least one vertex has to be visited twice as there are only $N$ vertices.
We denote the path as follows:
\begin{align}
    i \stackrel{w_0}{\rightarrow} \underbrace{... \rightarrow}_{a_1} k \underbrace{\rightarrow ... \rightarrow}_{a_2} k \underbrace{\rightarrow ...}_{a_3} \stackrel{w_k}{\rightarrow} j
\end{align}
We can build a path of length $N-1$ from $i$ to $j$ by cutting out the path from $k$ to $k$ in the middle of the path. 

Per definition of the shortest path, we get the following for the two paths:
\begin{align}
    &w_0 \otimes a_1 \otimes a_2 \otimes a_3 \otimes w_k \oplus w_0 \otimes a_1 \otimes a_3 \otimes w_k\\
    = &(w_0 \otimes a_1) \otimes (a_2 \otimes a_3 \otimes w_k \oplus a_3 \otimes w_k)\\
    = &(w_0 \otimes a_1) \otimes (a_2 \oplus 1) \otimes (\otimes a_3 \otimes w_k)\\
    = &(w_0 \otimes a_1) \otimes (1) \otimes (\otimes a_3 \otimes w_k) &&(\text{0-closed})\\
    = &w_0 \otimes a_1 \otimes a_3 \otimes w_k
\end{align}

\subsection*{d)}
We can
\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
